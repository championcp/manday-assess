# NESMA核心计算引擎测试验收标准

## 📋 文档信息
- **文档类型：** 测试验收标准 (Test Acceptance Criteria)
- **适用范围：** Sprint 1 - NESMA核心计算引擎
- **创建时间：** 2025-09-03
- **创建者：** Product Owner
- **协作者：** QA Test Engineer (配合执行)
- **质量等级：** 政府级项目 - 零缺陷要求

## 🎯 验收总体要求

### 核心验收标准
1. **100%准确性** - 所有计算结果与PDF指南完全一致
2. **零偏差容忍** - 不允许任何数值误差或舍入偏差
3. **全场景覆盖** - 覆盖所有功能点类型和复杂度组合
4. **边界条件验证** - 所有边界值判定必须准确
5. **性能达标** - 计算响应时间符合政府项目要求

### 验收成功定义
- [ ] 单元测试覆盖率 ≥ 95%
- [ ] 集成测试通过率 = 100%
- [ ] PDF指南案例验证通过率 = 100%
- [ ] 边界条件测试通过率 = 100%
- [ ] 性能测试达到预期指标
- [ ] 代码质量检查无Critical问题

## 🧪 详细测试用例规格

### 测试分类1：功能点类型识别测试

#### TC001: ILF识别和计算测试
```yaml
测试目标: 验证ILF功能点识别和计算的准确性
测试数据:
  - 场景1_简单ILF:
    - DET: 15
    - RET: 1
    - 预期复杂度: 简单
    - 预期功能点: 7
  
  - 场景2_一般ILF:
    - DET: 25
    - RET: 3
    - 预期复杂度: 一般
    - 预期功能点: 10
  
  - 场景3_复杂ILF:
    - DET: 55
    - RET: 8
    - 预期复杂度: 复杂
    - 预期功能点: 15

验收标准:
  - 复杂度判定100%准确
  - 功能点计算100%准确
  - BigDecimal精度正确(4位小数)
```

#### TC002: EIF识别和计算测试
```yaml
测试目标: 验证EIF功能点识别和计算的准确性
测试数据:
  - 场景1_简单EIF:
    - DET: 12
    - RET: 1
    - 预期复杂度: 简单
    - 预期功能点: 5
  
  - 场景2_一般EIF:
    - DET: 30
    - RET: 4
    - 预期复杂度: 一般
    - 预期功能点: 7
  
  - 场景3_复杂EIF:
    - DET: 60
    - RET: 10
    - 预期复杂度: 复杂
    - 预期功能点: 10

验收标准:
  - 复杂度矩阵应用正确
  - 权重配置准确
  - 计算结果精度符合要求
```

#### TC003: EI识别和计算测试
```yaml
测试目标: 验证EI功能点识别和计算的准确性
测试数据:
  - 场景1_简单EI:
    - DET: 10
    - FTR: 1
    - 预期复杂度: 简单
    - 预期功能点: 3
  
  - 场景2_一般EI:
    - DET: 18
    - FTR: 2
    - 预期复杂度: 一般
    - 预期功能点: 4
  
  - 场景3_复杂EI:
    - DET: 25
    - FTR: 5
    - 预期复杂度: 复杂
    - 预期功能点: 6

验收标准:
  - FTR计数逻辑正确
  - DET边界判定准确
  - 复杂度等级划分正确
```

#### TC004: EO识别和计算测试
```yaml
测试目标: 验证EO功能点识别和计算的准确性
测试数据:
  - 场景1_简单EO:
    - DET: 15
    - FTR: 1
    - 预期复杂度: 简单
    - 预期功能点: 4
  
  - 场景2_一般EO:
    - DET: 22
    - FTR: 3
    - 预期复杂度: 一般
    - 预期功能点: 5
  
  - 场景3_复杂EO:
    - DET: 30
    - FTR: 6
    - 预期复杂度: 复杂
    - 预期功能点: 7

验收标准:
  - 派生数据识别逻辑正确
  - 复杂度判定矩阵准确应用
  - 输出边界处理正确
```

#### TC005: EQ识别和计算测试
```yaml
测试目标: 验证EQ功能点识别和计算的准确性
测试数据:
  - 场景1_简单EQ:
    - DET: 12
    - FTR: 1
    - 预期复杂度: 简单
    - 预期功能点: 3
  
  - 场景2_一般EQ:
    - DET: 20
    - FTR: 3
    - 预期复杂度: 一般
    - 预期功能点: 4
  
  - 场景3_复杂EQ:
    - DET: 28
    - FTR: 5
    - 预期复杂度: 复杂
    - 预期功能点: 6

验收标准:
  - 查询逻辑识别准确
  - 输入输出组合判定正确
  - 无派生数据验证准确
```

### 测试分类2：边界条件测试

#### TC006: 复杂度判定边界测试
```yaml
测试目标: 验证复杂度判定矩阵的边界条件处理
测试场景:
  ILF边界测试:
    - DET=19, RET=1 -> 简单(7点)
    - DET=20, RET=1 -> 简单(7点)
    - DET=19, RET=2 -> 简单(7点)
    - DET=20, RET=2 -> 一般(10点)
    - DET=50, RET=1 -> 简单(7点)
    - DET=51, RET=1 -> 一般(10点)
    - DET=50, RET=6 -> 复杂(15点)
    - DET=51, RET=6 -> 复杂(15点)

验收标准:
  - 所有边界值判定100%准确
  - 临界点处理无误差
  - 边界两侧结果正确区分
```

#### TC007: 数值精度边界测试
```yaml
测试目标: 验证BigDecimal精度处理的边界情况
测试场景:
  - 极小数值计算(0.0001)
  - 极大数值计算(999999.9999)
  - 重复除法运算精度保持
  - 累积计算误差控制

验收标准:
  - 精度保持在规定范围内
  - 舍入行为符合HALF_UP标准
  - 无精度丢失或溢出
```

### 测试分类3：综合计算验证测试

#### TC008: UFP综合计算测试
```yaml
测试目标: 验证未调整功能点(UFP)的综合计算准确性
测试案例:
  输入数据:
    ILF: 3简单 + 2一般 + 1复杂
    EIF: 2简单 + 1一般 + 0复杂  
    EI: 5简单 + 3一般 + 2复杂
    EO: 4简单 + 2一般 + 1复杂
    EQ: 6简单 + 1一般 + 0复杂

  详细计算过程:
    ILF点数 = 3×7 + 2×10 + 1×15 = 21+20+15 = 56
    EIF点数 = 2×5 + 1×7 + 0×10 = 10+7+0 = 17
    EI点数 = 5×3 + 3×4 + 2×6 = 15+12+12 = 39
    EO点数 = 4×4 + 2×5 + 1×7 = 16+10+7 = 33
    EQ点数 = 6×3 + 1×4 + 0×6 = 18+4+0 = 22
    
    UFP总计 = 56+17+39+33+22 = 167

验收标准:
  - 每个功能点类型计算100%准确
  - UFP总计算准确无误
  - 中间计算过程可追溯
```

#### TC009: VAF调整因子计算测试
```yaml
测试目标: 验证技术复杂度调整因子(VAF)计算准确性
测试数据:
  影响因子评分:
    F1(数据通信): 4分
    F2(分布式数据处理): 3分
    F3(性能): 4分
    F4(高度使用的配置): 3分
    F5(事务率): 3分
    F6(在线数据输入): 5分
    F7(最终用户效率): 4分
    F8(在线更新): 3分
    F9(复杂处理): 4分
    F10(可重用性): 3分
    F11(安装简易性): 2分
    F12(操作简易性): 3分
    F13(多站点): 2分
    F14(变更便利性): 4分
    
  计算过程:
    影响度总和 = 4+3+4+3+3+5+4+3+4+3+2+3+2+4 = 47
    VAF = 0.65 + 0.01 × 47 = 0.65 + 0.47 = 1.12

验收标准:
  - 影响因子评分规则正确应用
  - VAF计算公式100%准确
  - VAF范围控制[0.65, 1.35]有效
```

#### TC010: AFP调整功能点计算测试
```yaml
测试目标: 验证调整功能点(AFP)的综合计算
测试场景:
  基础数据:
    UFP = 167 (来自TC008)
    VAF = 1.12 (来自TC009)
  
  计算过程:
    AFP = UFP × VAF = 167 × 1.12 = 187.04

验收标准:
  - AFP计算公式应用正确
  - BigDecimal精度保持4位小数
  - 结果与手工计算100%一致
```

#### TC011: 复用度调整计算测试
```yaml
测试目标: 验证复用度调整的准确计算
测试场景:
  基础数据:
    AFP = 187.04 (来自TC010)
  
  复用等级测试:
    高复用度: 187.04 × (1/3) = 187.04 × 0.3333 = 62.3467
    中复用度: 187.04 × (2/3) = 187.04 × 0.6667 = 124.6933
    低复用度: 187.04 × 1 = 187.04 × 1.0000 = 187.0400

验收标准:
  - 复用系数计算精度正确
  - 分数运算使用BigDecimal
  - 最终结果保持4位小数精度
```

### 测试分类4：PDF指南案例验证测试

#### TC012: 政府指南标准案例验证
```yaml
测试目标: 与《长沙市财政评审中心政府投资信息化项目评审指南》案例100%一致性验证
测试数据: [基于PDF指南具体案例]
  
验收标准:
  - 计算结果与PDF案例完全一致
  - 中间步骤与指南描述完全匹配
  - 无任何数值偏差或舍入误差
  - 计算逻辑与标准流程完全符合
```

### 测试分类5：性能和稳定性测试

#### TC013: 计算性能测试
```yaml
测试目标: 验证NESMA计算引擎的性能表现
测试场景:
  - 单次计算响应时间测试
  - 并发计算能力测试  
  - 大规模功能点计算测试
  - 内存使用效率测试

性能指标要求:
  - 单次UFP计算 < 100ms
  - 完整NESMA计算 < 500ms
  - 50并发计算请求稳定处理
  - 1000+功能点项目计算 < 2s

验收标准:
  - 所有性能指标达到预期要求
  - 无内存泄漏或资源占用异常
  - 高并发情况下计算准确性保持
```

#### TC014: 系统稳定性测试
```yaml
测试目标: 验证系统在各种异常情况下的稳定性
测试场景:
  - 异常输入数据处理
  - 边界值溢出处理
  - 网络异常情况处理
  - 数据库连接异常处理

验收标准:
  - 异常情况下系统不崩溃
  - 错误信息明确且有帮助
  - 系统能够优雅降级
  - 数据完整性得到保证
```

## 📊 测试执行计划

### 测试阶段划分

#### 第一阶段：单元测试 (开发阶段)
**执行者：** Developer Engineer  
**时间安排：** 代码开发同步进行  
**覆盖范围：**
- [ ] 每个功能点类型的计算逻辑
- [ ] 复杂度判定算法
- [ ] BigDecimal精度处理
- [ ] 边界条件处理

**验收标准：**
- 单元测试覆盖率 ≥ 95%
- 所有单元测试100%通过
- 代码质量检查无Critical问题

#### 第二阶段：集成测试 (开发后期)
**执行者：** Developer Engineer + QA Test Engineer  
**时间安排：** 核心功能完成后  
**覆盖范围：**
- [ ] UFP、AFP、最终功能点的端到端计算
- [ ] 数据库集成测试
- [ ] API接口集成测试
- [ ] 性能基础测试

**验收标准：**
- 集成测试100%通过
- API接口响应正确
- 数据持久化正常

#### 第三阶段：验收测试 (Sprint结束前)
**执行者：** QA Test Engineer + Product Owner  
**时间安排：** Sprint 1最后3天  
**覆盖范围：**
- [ ] PDF指南案例完整验证
- [ ] 用户场景测试
- [ ] 性能压力测试
- [ ] 安全性测试

**验收标准：**
- PDF指南案例验证100%通过
- 所有用户场景测试通过
- 性能指标达到要求
- 安全测试无重大风险

## 🛠️ 测试工具和环境要求

### 测试框架要求
```yaml
单元测试:
  - JUnit 5
  - Mockito
  - AssertJ (数值断言)
  
集成测试:
  - Spring Boot Test
  - TestContainers (数据库测试)
  - WireMock (外部依赖模拟)

性能测试:
  - JMeter (压力测试)
  - JProfiler (性能分析)
  - Spring Boot Actuator (监控)
```

### 测试数据要求
```yaml
标准测试数据集:
  - PDF指南官方案例数据
  - 边界条件测试数据
  - 异常场景测试数据
  - 性能压力测试数据

数据准备原则:
  - 测试数据可重现
  - 覆盖所有功能点类型组合
  - 包含边界值和异常值
  - 支持自动化测试执行
```

### 测试环境配置
```yaml
开发测试环境:
  - PostgreSQL 13+
  - Redis 6+
  - Java 17
  - Maven 3.8+

CI/CD测试环境:
  - Docker容器化测试
  - 自动化测试流水线
  - 测试报告生成
  - 质量门禁检查
```

## 📋 测试交付物清单

### 必须交付的测试文档
- [ ] 测试执行报告
- [ ] 单元测试覆盖率报告
- [ ] 集成测试结果报告
- [ ] PDF指南案例验证报告
- [ ] 性能测试报告
- [ ] 缺陷分析报告

### 测试代码交付物
- [ ] 完整的单元测试代码
- [ ] 集成测试用例代码
- [ ] 性能测试脚本
- [ ] 测试数据生成工具
- [ ] 自动化测试流水线配置

## ✅ 最终验收检查清单

### 功能验收检查
- [ ] 5种功能点类型计算100%准确
- [ ] 复杂度判定逻辑100%正确
- [ ] UFP/AFP/最终功能点计算准确
- [ ] 调整因子应用正确
- [ ] 复用度调整计算准确

### 质量验收检查  
- [ ] 单元测试覆盖率≥95%
- [ ] 所有测试用例100%通过
- [ ] PDF指南案例验证100%通过
- [ ] 代码质量无Critical问题
- [ ] 性能指标达到预期要求

### 合规验收检查
- [ ] 计算逻辑完全符合政府指南
- [ ] 数据精度满足政府项目要求
- [ ] 审计日志记录完整
- [ ] 安全性测试通过
- [ ] 文档完整且准确

## 🚨 验收失败处理流程

### 轻微问题处理
- 数值精度小偏差(< 0.01%)
- 性能略低于预期(< 10%)
- 非关键功能异常

**处理方式：** 
1. 记录问题并评估影响
2. 制定修复计划
3. 在下个迭代中修复
4. 不阻塞Sprint交付

### 重大问题处理
- 计算结果与PDF指南不一致
- 核心算法逻辑错误
- 关键性能指标严重不达标
- 安全性重大风险

**处理方式：**
1. 立即停止交付流程
2. 组织团队紧急修复
3. 重新执行完整测试验证
4. 通过验收后才能交付

---

**文档维护者：** Product Owner  
**测试执行者：** QA Test Engineer  
**开发配合者：** Developer Engineer  
**最后更新：** 2025-09-03  

**严重提醒：政府项目测试验收标准严格执行，任何计算偏差都可能影响项目成败！**